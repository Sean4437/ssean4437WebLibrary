<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>麗鄴電子白板-布局1</title>
    <link rel="stylesheet" href="main.css" />
  </head>
  <body>
    <div class="app-shell">

      <section class="panel">
        <h3>資料輸入面板</h3>
        <div class="data-grid">
          <div class="form-field">
            <label for="inputProjectName">工程名稱</label>
            <input
              id="inputProjectName"
              type="text"
              placeholder="請輸入工程名稱"
              autocomplete="off"
            />
            <div class="history-dropdown" id="projectNameHistoryDropdown"></div>
          </div>
          <div class="form-field">
            <label for="inputInspectionLocation">檢查位置</label>
            <input
              id="inputInspectionLocation"
              type="text"
              placeholder="請輸入檢查位置"
              autocomplete="off"
            />
            <div class="history-dropdown" id="inspectionLocationHistoryDropdown"></div>
          </div>
          <div class="form-field">
            <label for="inputTestDate">檢查日期</label>
            <input id="inputTestDate" type="date" />
          </div>
          <div class="form-field">
            <label for="inputInspector">檢查人員</label>
            <input
              id="inputInspector"
              type="text"
              placeholder="請輸入檢查人員"
              autocomplete="off"
            />
            <div class="history-dropdown" id="inspectorHistoryDropdown"></div>
          </div>
          <div class="form-field" style="grid-column: 1 / -1">
            <label for="inputTestResult">檢查紀錄</label>
            <textarea
              id="inputTestResult"
              placeholder="寫下檢查內容、測量結果等"
              autocomplete="off"
            ></textarea>
            <div class="history-dropdown" id="testResultHistoryDropdown"></div>
          </div>
          <div class="form-field">
            <label for="coordinateFormatButton">座標顯示</label>
            <button type="button" class="coordinate-toggle-btn" id="coordinateFormatButton">
              <span>點擊切換</span>
              <strong id="coordinateFormatText">TWD97</strong>
            </button>
          </div>
        </div>
        <div class="panel-actions">
          <label class="panel-control">
            <span>文字大小</span>
            <input type="range" id="fontScale" min="80" max="300" value="200" />
            <span id="fontScaleValue">200%</span>
          </label>
          <label class="panel-control">
            <span>白板寬度</span>
            <input type="range" id="boardWidth" min="240" max="640" value="350" />
            <span id="boardWidthValue">350px</span>
          </label>
          <div class="color-preset-group" role="group" aria-label="白板配色快捷">
            <button
              type="button"
              class="color-swatch"
              style="--swatch-color: #f8fafc"
              data-color-preset
              data-board-color="#f8fafc"
              data-text-color="#0f172a"
              data-line-color="#000000"
              data-board-opacity="100"
              aria-label="白色主題"
            >
              <span class="sr-only">白色主題</span>
            </button>
            <button
              type="button"
              class="color-swatch"
              style="--swatch-color: #065f46"
              data-color-preset
              data-board-color="#065f46"
              data-text-color="#f8fafc"
              data-line-color="#f8fafc"
              data-board-opacity="100"
              aria-label="綠色主題"
            >
              <span class="sr-only">綠色主題</span>
            </button>
            <button
              type="button"
              class="color-swatch"
              style="--swatch-color: rgba(15, 23, 42, 0.5)"
              data-color-preset
              data-board-color="#1f293b"
              data-text-color="#f8fafc"
              data-line-color="#f8fafc"
              data-board-opacity="85"
              aria-label="半透明灰主題"
            >
              <span class="sr-only">半透明灰主題</span>
            </button>
            <button
              type="button"
              class="color-swatch"
              style="--swatch-color: rgba(255, 255, 255, 0.8)"
              data-color-preset
              data-board-color="#f8fafc"
              data-text-color="#0f172a"
              data-line-color="#000000"
              data-board-opacity="82"
              aria-label="半透明白主題"
            >
              <span class="sr-only">半透明白主題</span>
            </button>
            <button
              type="button"
              class="color-swatch color-swatch--toggle"
              id="toggleBoardButton"
              aria-pressed="true"
              data-board-visible="true"
            >
              <span class="sr-only">白板顯示開關</span>
              <span id="boardVisibilityLabel">白板開</span>
            </button>
          </div>
        </div>
        <button type="button" class="ghost-btn toggle-advanced" id="toggleAdvanced">顯示更多調整</button>
        <div class="panel-actions advanced-controls" id="advancedControls" hidden>
          <label class="panel-control">
            <span>白板尺寸</span>
            <input type="range" id="boardScale" min="10" max="120" value="45" />
            <span id="boardScaleValue">45%</span>
          </label>
          <label class="panel-control">
            <span>輸出尺寸</span>
            <div class="size-toggle-group" role="group" aria-label="輸出尺寸選擇">
              <button type="button" class="size-toggle" data-export-size="small">小</button>
              <button type="button" class="size-toggle" data-export-size="medium">中</button>
              <button type="button" class="size-toggle is-active" data-export-size="large">大</button>
            </div>
          </label>
          <label class="panel-control">
            <span>座標紀錄</span>
            <div class="history-actions">
              <button type="button" class="ghost-btn ghost-button--accent" id="downloadCoordinateHistory">下載紀錄</button>
              <button type="button" class="ghost-btn ghost-button--danger" id="clearCoordinateHistory">清除紀錄</button>
            </div>
          </label>
          <label class="panel-control">
            <span>白板傾斜</span>
            <input type="range" id="boardRotation" min="-20" max="20" value="0" />
            <span id="boardRotationValue">0°</span>
          </label>
          <label class="panel-control">
            <span>白板顏色</span>
            <input type="color" id="boardColor" value="#f8fafc" />
          </label>
          <label class="panel-control">
            <span>透明度</span>
            <input type="range" id="boardOpacity" min="70" max="100" value="96" />
            <span id="boardOpacityValue">96%</span>
          </label>
          <label class="panel-control">
            <span>文字顏色</span>
            <input type="color" id="textColor" value="#0f172a" />
          </label>
          <label class="panel-control">
            <span>格線顏色</span>
            <input type="color" id="lineColor" value="#000000" />
          </label>
        </div>
      </section>

      <div class="controls">
        <button class="btn" id="takePhotoBtn">拍照</button>
        <button class="btn btn-secondary" id="uploadPhotoBtn">上傳照片</button>
      </div>

      <div class="stage" id="captureArea">
        <div class="stage-content" id="photoLayer">
          <img id="photoImage" alt="拍攝預覽" hidden />
          <div class="stage-placeholder" id="placeholder">
            <strong>請拍照或上傳照片</strong>
            <span>白板會顯示在畫面上，可拖曳與縮放。</span>
          </div>
        </div>
        <div class="whiteboard-wrapper" id="whiteboardWrapper">
          <div class="whiteboard" id="whiteboard">
            <div class="whiteboard-content">
              <div class="board-row">
                <label>工程名稱</label>
                <div class="board-value" id="displayProjectName">—</div>
              </div>
              <div class="board-row">
                <label>檢查位置</label>
                <div class="board-value" id="displayInspectionLocation">—</div>
              </div>
              <div class="board-block">
                <label>檢查紀錄</label>
                <div class="board-notes" id="displayTestResult">—</div>
              </div>
              <div class="board-row">
                <label>檢查日期</label>
                <div class="board-value" id="displayTestDate">—</div>
              </div>
              <div class="board-row">
                <label>檢查人員</label>
                <div class="board-value" id="displayInspector">—</div>
              </div>
            </div>
          </div>
        </div>
        <div class="photo-watermark photo-watermark--top-right" id="photoCoordinate" hidden>座標未取得</div>
        <div class="photo-watermark" id="photoWatermark">日期未設定</div>
      </div>

      <div class="action-bar">
        <button class="action-btn secondary" id="clearBoardBtn">清除白板</button>
        <button class="action-btn primary" id="exportBtn">匯出整張圖片</button>
      </div>

      <p id="toastMessage" class="toast-message" role="status" aria-live="polite"></p>

      <input type="file" accept="image/*" capture="environment" class="hidden-input" id="takePhotoInput" />
      <input type="file" accept="image/*" class="hidden-input" id="uploadInput" />
    </div>

    <script src="https://cdn.jsdelivr.net/npm/piexifjs@1.0.6/piexif.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    
    <script src="main.js"></script>
  </body>
</html>
